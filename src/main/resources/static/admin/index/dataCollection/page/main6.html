<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>数据收集</title>
    <link rel="stylesheet" href="../layui/css/layui.css">
    <link rel="stylesheet" href="../iconfont/iconfont.css">
    <link rel="stylesheet" href="../css/dataIndex.css">
    <script src="../js/jquery-3.3.1.min.js"></script>
    <script src="../iconfont/iconfont.js"></script>
    <script src="../../../../static/admin/js/basic.js"></script>
</head>
<body>



<!-- 表格 -->
<table class="layui-hide" id="table" lay-filter="table1"></table>


    <!--批量删除和添加-->
    <script type="text/html" id="zq_toolbar">
        <div class="layui-btn-container">
            <button class="layui-btn layui-btn-danger layui-btn-sm" lay-event="delAll"><i class="layui-icon"></i>批量删除</button>
            <a class="layui-btn layui-btn-sm" href="add4.html"><i class="layui-icon"></i>添加</a>
        </div>
    </script>

    <script type="text/html" id="toolBar">
        <!-- 搜索区域 -->
        <div class="index_search index_search3" style="margin-top: -10px;">
            <form class="layui-form" action="">
                    <!--设备编号-->
                    <div class="layui-input-inline" style="width: 100px;">
                        <input type="text" name="id" autocomplete="off"
                               placeholder="设备编号" class="layui-input">
                    </div>
                    <!--设备拼音码-->
                    <div class="layui-input-inline" style="width: 100px;">
                        <input type="text" name="name" autocomplete="off"
                               placeholder="设备拼音码" class="layui-input">
                    </div>
                    <div class="layui-input-inline" style="width: 80px;">
                        <button class="layui-btn" data-type="reload">查找</button>
                    </div>
            </form>
        </div>
    </script>

    <!--编辑和删除-->
    <script type="text/html" id="barDemo">
        <a class="layui-btn layui-btn-xs" href="edit4.html">编辑</a>
        <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="delete">
            删除</a>
    </script>

<script src="../layui/layui.js"></script>
<script src="../js/dataIndex.js"></script>
<script>

    renderMod = {
        addTable: {
            table: {
                cols: [[ //表头
                    {type: 'checkbox', fixed: 'left'}
                    ,{field:'id', title:'设备编号'}
                    ,{field:'name', title:'设备简称'}
                    ,{field:'mType',title:'M值类型'}
                    ,{field:'morning', title:'上午班核定工时(次)'}
                    ,{field:'afternoon', title:'下午班核定工时(次)'}
                    ,{field:'night', title:'晚班核定工时(次)'}
                    ,{fixed: 'right', title:'操作', align:'center', toolbar: '#barDemo',width:120}
                ]]
                , url: "../json/main6.json"
                , method: "POST"
                , request: {
                    pageName: 'pageNum',
                    limitName: 'pageSize'
                }
                , where: {}
                , parseData: function (res) { //res 即为原始返回的数据
                    return {
                        "code": res.code, //解析接口状态
                        "msg": res.msg, //解析提示文本
                        "data": res.data.list, //解析数据列表
                        "count": res.data.total //总数据数
                    }
                }
                ,done: function(obj){
                    tableFunc({
                        "tools":[
                            {//一个基础的删除当前行数据按钮
                                event: "delete",
                                layOpen:false,
                                func:function(obj){
                                    layer.confirm('确定删除这一行吗？', function(index){
                                        subUp({
                                            url:"../json/main6.json",
                                            data:{"aId":obj.data.aid},
                                            success:function(res){
                                                if(res.code === 0){
                                                    obj.del(); //删除对应行（tr）的DOM结构，并更新缓存
                                                    putMsg({
                                                        msg:"您已成功删除一条数据！"
                                                    });
                                                    layer.close(index);
                                                }
                                            }
                                        })
                                    });
                                }
                            }
                        ]
                    })
                }
            },

            reSet: {
                url: "../json/main6.json",
                type: "reload",
                tid: "table",
                data: ["id", "name"],
                method: "POST"
            }
        }
    };
    renderMod.form = {
        date:{
            elem:"#date1",
            value:today,
            type:"datetime",
            format:'yyyy-MM-dd',
            isInitValue:false
        }
    }

    //JavaScript代码区域
    // layui.use('element', function(){
    //     var element = layui.element;
    // });
    //
    // // 表单
    // layui.use(['form', 'layedit', 'laydate'], function(){
    //     var form = layui.form
    //         ,layer = layui.layer
    //         ,layedit = layui.layedit
    //         ,laydate = layui.laydate;
    //
    //     //日期
    //     laydate.render({
    //         elem: '#indexDateSelect'
    //         ,type: 'datetime'
    //         ,value: new Date()
    //     });
    // });
    //
    // // 表格
    // layui.use('table', function(){
    //     var table = layui.table;
    //
    //     table.render({
    //         elem: '#zq_table'
    //         ,url:'../json/main6.json'
    //         ,height: 'full-40'
    //         ,totalRow: true //开启合计行
    //         ,toolbar: '#zq_toolbar'
    //         ,cellMinWidth: 50
    //         ,title: '单机设备运行记录'
    //         ,cols: [[
    //             {type: 'checkbox', fixed: 'left'}
    //             ,{field:'id', title:'设备编号'}
    //             ,{field:'name', title:'设备简称'}
    //             ,{field:'mType',title:'M值类型'}
    //             ,{field:'morning', title:'上午班核定工时(次)'}
    //             ,{field:'afternoon', title:'下午班核定工时(次)'}
    //             ,{field:'night', title:'晚班核定工时(次)'}
    //             ,{fixed: 'right', title:'操作', align:'center', toolbar: '#barDemo',width:120}
    //         ]]
    //         ,page: true
    //     });
    //
    //     table.on('toolbar(text)', function(obj){
    //         console.log(1);
    //     });
    //
    //     //监听头工具栏事件
    //     table.on('toolbar(zq_table)', function(obj){
    //         var checkStatus = table.checkStatus(obj.config.id)
    //             ,data = checkStatus.data; //获取选中的数据
    //         //json字符串转换成Json数据 eval("("+jsonStr+")")  /JSON.parse(jsonStr)
    //         data = eval("("+JSON.stringify(data)+")");
    //         console.log(data);
    //         switch(obj.event){
    //             case 'delAll':
    //                 if(data.length === 0){
    //                     layer.msg('请至少选择1行', { icon: 2, time: 1500 });
    //                 }else {
    //                     layer.alert('您确认要删除'+data.length+'条数据吗？', {
    //                         skin: 'layui-layer-molv' //样式类名layui-layer-lan或layui-layer-molv  自定义样式
    //                         ,closeBtn: 1    // 是否显示关闭按钮
    //                         ,anim: 1 //动画类型
    //                         ,btn: ['确定','取消'] //按钮
    //                         ,icon: 2    // icon
    //                         ,yes:function(){
    //                             // layer.msg('确定', { icon: 1, time: 1500 });
    //                             for (var i=0;i<data.length;i++){
    //
    //                                 console.log(data[i]);
    //                                 // data[i].remove();
    //
    //                             }
    //                             /*   //捉到所有被选中的，发异步进行删除
    //                                layer.msg('删除成功', {icon: 1});
    //                                $(".layui-form-checked").not('.header').parents('tr').remove();*/
    //                         }
    //                         ,btn2:function(){
    //                             layer.msg('好的,暂时不给您删除。',{ icon: 1, time: 1500 });
    //                         }
    //                     });
    //                 }
    //                 break;
    //             case 'add':
    //                 zq_form('添加菜单','url这个值不管','','');
    //                 //数据回显
    //                 // $("#zq_form").setForm({id:data.id,name: data.name, url: data.url,icon:data.icon,parent:data.parent,children:data.children});
    //                 $("#zq_form").setForm({id:''});
    //                 break;
    //         }
    //     });
    //
    //     //监听行工具事件
    //     table.on('tool(zq_table)', function(obj){
    //         var data = obj.data;
    //         //console.log(obj)
    //         if(obj.event === 'del'){
    //             layer.confirm('确认删除', function(index){
    //                 obj.del();
    //                 layer.close(index);
    //             });
    //         } else if(obj.event === 'edit'){
    //             layer.prompt({
    //                 formType: 2
    //                 ,value: data.email
    //             }, function(value, index){
    //                 obj.update({
    //                     email: value
    //                 });
    //                 layer.close(index);
    //             });
    //         }
    //     });
    // });
</script>
</body>
</html>
