<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>特种设备新增</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="../../../../../static/admin/layui/css/layui.css">
    <script src="../../../../../static/admin/js/jquery-1.11.3.min.js"></script>
    <script src="../../../../../static/admin/js/jquery-3.3.1.min.js"></script>
    <script src="../../../../../static/admin/layui/layui.js"></script>
    <script src="../../../../../static/admin/js/basic.js"></script>


</head>
<body>
<div class="layui-row" style="margin: 20px">
    <div class="col-xs-12">
      <form class="layui-form  layui-form-pane" action="" >

      <div class="layui-col-md6" style="padding: 10px;">

        <div class="layui-form-item">
            <label class="layui-form-label">设备编号</label>
            <div class="layui-input-block">
                <input type="text" name="speqBh" lay-verify="required"
                       placeholder="请输入" autocomplete="off" class="layui-input speqBh">
            </div>
        </div>


        <div class="layui-form-item">
            <label class="layui-form-label">设备名称</label>
            <div class="layui-input-block">
                <input type="text" name="speqName" lay-verify="required"
                       placeholder="请输入" autocomplete="off" class="layui-input speqName">
            </div>
        </div>


        <div class="layui-form-item" >
            <label class="layui-form-label">类型</label>
            <div class="layui-input-block speqType">
                <input type="radio" name="speqType" id="speqType1" value="1" title="特种设备"  lay-filter="speqType" checked>
                <input type="radio" name="speqType" id="speqType2" value="0" title="安全附件"   lay-filter="speqType" >
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">规格型号</label>
            <div class="layui-input-block">
                <input type="text" name="speqGgxh" lay-verify="required" placeholder="请输入"
                       autocomplete="off" class="layui-input speqGgxh">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">生产商</label>
            <div class="layui-input-block">
                <input type="text" name="speqScs" lay-verify="required" placeholder="请输入"
                       autocomplete="off" class="layui-input speqScs">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">出厂编号</label>
            <div class="layui-input-block">
                <input type="text" name="speqCcbh" lay-verify="required" placeholder="请输入"
                       autocomplete="off" class="layui-input speqCcbh">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label">检测证编号</label>
            <div class="layui-input-block">
                <input type="text" name="speqJczbh" lay-verify="required" placeholder="请输入"
                       autocomplete="off" class="layui-input speqJczbh">
            </div>
        </div>

        <div class="layui-form-item" id="speqZczbh">
            <label class="layui-form-label">注册编号</label>
            <div class="layui-input-block">
                <input type="text" name="speqZczbh"  placeholder="请输入" lay-verify="required"
                       autocomplete="off" class="layui-input speqZczbh">
            </div>
        </div>

    </div>
       <div class="layui-col-md6" style="padding: 10px;">
        <div class="layui-form-item">
            <label class="layui-form-label">使用科室</label>
            <div class="layui-input-block">
                <input type="button" class="layui-btn bmId" title="科室" value="科室"
                       lay-filter="bmId" style="float:left;">
                <input type="text" lay-verify="required" readonly="readonly"  style="float:left; width: 100px;height: 35px;border: none;margin-left: 15px" name ='bmId' id="bmId" value="">
            </div>
        </div>

        <div class="layui-form-item" >
            <div class="layui-inline" >
                <label class="layui-form-label" title="上次检测时间">上次检测时间</label>
                <div class="layui-input-block">
                    <input type="text" name="speqJcsj" id="date1" lay-verify="date" placeholder="yyyy-MM-dd" readonly="readonly" autocomplete="off" class="layui-input speqJcsj" >
                </div>

            </div>
        </div>

        <div class="layui-form-item" >
            <div class="layui-inline" >
                <label class="layui-form-label" title="检测周期（月）" >检测周期（月）</label>
                <div class="layui-input-block">
                    <input type="text" name="speqJczq" lay-verify="required|number"  placeholder="请输入   检测周期（月）" autocomplete="off" class="layui-input speqJczq">
                </div>
            </div>
        </div>

        <div class="layui-form-item ">
            <label class="layui-form-label">院区</label>
            <div class="layui-input-block" >
                <input type="text" name="speqBz" lay-verify="required"  placeholder="院区" autocomplete="off" class="layui-input speqBz">
            </div>
        </div>

        <div class="layui-form-item">
            <label class="layui-form-label" >单价</label>
            <div class="layui-input-block">
                <input type="text" name="speqSpare1" lay-verify="required|number" placeholder="请输入" autocomplete="off" class="layui-input speqSpare1">
            </div>
        </div>

        <div class="layui-form-item" id="speqSyzbh">
            <label class="layui-form-label" >使用编号</label>
            <div class="layui-input-block">
                <input type="text" name="speqSyzbh" lay-verify="required"  placeholder="请输入" autocomplete="off" class="layui-input speqSyzbh">
            </div>
        </div>

        <div class="layui-form-item" id="aqfjJddj" >
            <label class="layui-form-label" >精度等级</label>
            <div class="layui-input-block">
                <input type="text" name="aqfjJddj" lay-verify="required" placeholder="请输入" autocomplete="off" class="layui-input aqfjJddj" >
            </div>
        </div>

        <div class="layui-form-item" style="margin-top: 70px">
            <div class="layui-input-block">
                <button class="layui-btn" lay-submit="" lay-filter="demo1" id="demo1">立即提交</button>
                <button type="reset" class="layui-btn layui-btn-primary emo1"  >重置</button>
            </div>
        </div>

    </div>

</form>
    </div>
</div>
<script>

    layui.use('element', function() {
        var element = layui.element;
        /*element.on('tab(demo)', function (data) {
            console.log(data);
        });*/
    });

    layui.use(['form', 'layedit', 'laydate'], function () {
        var form = layui.form
            , layer = layui.layer
            , layedit = layui.layedit
            , laydate = layui.laydate
            , $ = layui.$;

        form.render();
        //日期
        laydate.render({
            elem: '#date'
        });
        laydate.render({
            elem: '#date1'
        });
        laydate.render({
            elem: '#date2'
        });

        /*    特种设备和安全附件的不同显示*/
        if ($('#speqType1').is(':checked')) {
            $("#aqfjJddj").hide();
            $("#speqSyzbh").show();
            $("#speqZczbh").show();
            $("#aqfjJddj").find(".aqfjJddj").val(" ");
            $("#aqfjJddj").find(".aqfjJddj").removeAttr("lay-verify");
            $("#speqSyzbh").find(".speqSyzbh").attr("lay-verify","required");
            $("#speqZczbh").find(".speqZczbh").attr("lay-verify","required");
        }
        else if ($('#speqType2').is(':checked')) {
            $("#speqSyzbh").hide();
            $("#speqZczbh").hide();
            $("#aqfjJddj").show();
            $("#speqSyzbh").find(".speqSyzbh").val(" ");
            $("#speqZczbh").find(".speqZczbh").val(" ");
            $("#aqfjJddj").find(".aqfjJddj").attr("lay-verify");
            $("#speqSyzbh").find(".speqSyzbh").removeAttr("lay-verify","required");
            $("#speqZczbh").find(".speqZczbh").removeAttr("lay-verify","required");
        }
        form.on("radio(speqType)", function (data) {
            if (data.value === '1') {
                $("#aqfjJddj").hide();
                $("#speqSyzbh").show();
                $("#speqZczbh").show();
                $("#aqfjJddj").find(".aqfjJddj").val(" ");
                $("#aqfjJddj").find(".aqfjJddj").removeAttr("lay-verify");
                $("#speqSyzbh").find(".speqSyzbh").attr("lay-verify","required");
                $("#speqZczbh").find(".speqZczbh").attr("lay-verify","required");

            } else if (data.value === '0') {
                $("#speqSyzbh").hide();
                $("#speqZczbh").hide();
                $("#aqfjJddj").show();
                $("#speqSyzbh").find(".speqSyzbh").val(" ");
                $("#speqZczbh").find(".speqZczbh").val(" ");
                $("#aqfjJddj").find(".aqfjJddj").attr("lay-verify","required");
                $("#speqSyzbh").find(".speqSyzbh").removeAttr("lay-verify","required");
                $("#speqZczbh").find(".speqZczbh").removeAttr("lay-verify","required");
            }

        });

        /* 科室弹窗*/
        $('.bmId').on('click', function () {
            var $ = layui.jquery;
            layui.layer.open({
                type: 2,
                title: '科室',
                shadeClose: true, //点击遮罩关闭层
                area: ['800px', '470px'],
                content: './index1-BM.html'
            });
        });

        //监听提交
        form.on('submit(demo1)', function (data) {
              $.ajax({
                  url:'/specialEq/insertSpecialEq',
                   type:"POST",
                  async: false,/*同步传输*/
                  data:JSON.stringify(data.field),
                  dataType:'JSON',
                  contentType:'application/json' ,
                  success: function(res){
                        if(res.code == 0 ){
                            /*layer.msg("请求发送成功！",{icon: 6,time:3000});*/
                            var index = parent.layer.getFrameIndex(window.name);
                            parent.layer.close(index);
                            parent.location.reload();
                        }else{
                            alert(res.msg);
                        }
                  },
                  error:function (data) {
                    }
              }) ;

        });


        /*重置时特殊设备和安全附件的不同显示*/
        $('.emo1').on('click', function () {
            $("#aqfjJddj").hide();
            $("#speqSyzbh").show();
            $("#speqZczbh").show();
        })
    });


</script>


</body>
</html>