<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <title>编写</title>
    <link rel="stylesheet" type="text/css" href="/static/admin/layui/css/layui.css"/>
    <link rel="stylesheet" type="text/css" href="/static/admin/css/admin.css"/>
    <script src="/static/admin/js/jquery-3.3.1.min.js"></script>
    <!--[if IE 8]>
    <script type="text/javascript" src="/static/admin/js/jquery-1.11.3.min.js"></script>
    <![endif]-->
    <script src="/static/admin/js/basic.js"></script>
    <style>
        .layui-form-label {
            width: 130px !important;
        }

        .layui-input-block {
            margin-left: 130px !important;
        }

        .layui-form-text .layui-form-label {
            width: 100% !important;
        }

        .layui-form-text .layui-input-block {
            margin-left: 0 !important;
        }

        input[type="file"] {
            margin: 7px;
        }
    </style>
</head>

<body>
<form class="layui-form layui-form-pane" action="">
    <div class="layui-row">
        <fieldset class="layui-elem-field layui-field-title">
            <legend>设备信息</legend>
        </fieldset>
        <div class="col-xs-12 col-sm-6">
            <div class="layui-form-item">
                <label class="layui-form-label">设备品名<span class="sign">*</span></label>
                <div class="layui-input-block">
                    <input type="text" name="eqPmName" disabled class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">设备品牌</label>
                <div class="layui-input-block">
                    <input type="text" name="eqPp" disabled class="layui-input">
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-sm-6">
            <div class="layui-form-item">
                <label class="layui-form-label">设备规格</label>
                <div class="layui-input-block">
                    <input type="text" name="eqGg" disabled class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">设备型号</label>
                <div class="layui-input-block">
                    <input type="text" name="eqXh" disabled class="layui-input">
                </div>
            </div>
        </div>
    </div>
    <div class="layui-row">
        <fieldset class="layui-elem-field layui-field-title">
            <legend>操作规程信息</legend>
        </fieldset>
        <div class="col-xs-12 col-sm-6">
            <div class="layui-form-item">
                <label class="layui-form-label">操作规程名称 <span class="sign">*</span></label>
                <div class="layui-input-block">
                    <input type="text" name="title" disabled class="layui-input">
                </div>
            </div>
            <div class="layui-form-item layui-form-text">
                <label class="layui-form-label">操作规程内容</label>
                <div class="layui-input-block">
                    <textarea type="text" name="czGcNr" disabled id="czGcNr" class="layui-textarea"></textarea>
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-sm-6">
            <div class="layui-form-item">
                <label class="layui-form-label">拟稿人<span class="sign">*</span></label>
                <div class="layui-input-block">
                    <input type="text" name="czGcNgr" id="czGcNgr" disabled class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">类别<span class="sign">*</span></label>
                <div class="layui-input-block">
                    <input type="text" name="czGcLb" disabled value="操作流程" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">总页数<span class="sign">*</span></label>
                <div class="layui-input-block">
                    <input type="text" name="czGcZys" disabled class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">拟稿日期<span class="sign">*</span></label>
                <div class="layui-input-block">
                    <input type="text" name="czGcNgrq" id="czGcNgrq" disabled class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">版本号<span class="sign">*</span></label>
                <div class="layui-input-block">
                    <input type="text" name="czGcBbh" disabled value="V1.0" class="layui-input">
                </div>
            </div>
        </div>
    </div>
    <div class="layui-row">
        <fieldset class="layui-elem-field layui-field-title">
            <legend>审核信息</legend>
        </fieldset>
        <div class="col-xs-12 col-sm-6">
            <div class="layui-form-item">
                <label class="layui-form-label">审核人<span class="sign">*</span></label>
                <div class="layui-input-block">
                    <input type="text" name="czGcShr" disabled class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">审核日期<span class="sign">*</span></label>
                <div class="layui-input-block">
                    <input type="text" name="czGcShrq" disabled class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">试用天数(天)<span class="sign">*</span></label>
                <div class="layui-input-block">
                    <input type="text" name="czGcSyts" id="date3" disabled class="layui-input">
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-sm-6">
            <div class="layui-form-item layui-form-text">
                <label class="layui-form-label">审核意见<span class="sign">*</span></label>
                <div class="layui-input-block">
                    <textarea type="text" name="czGcShyj" disabled class="layui-textarea"></textarea>
                </div>
            </div>
        </div>
    </div>
    <div class="layui-row">
        <fieldset class="layui-elem-field layui-field-title">
            <legend>审核信息</legend>
        </fieldset>
        <div class="col-xs-12 col-sm-6">
            <div class="layui-form-item">
                <label class="layui-form-label">再评价审核人<span class="sign">*</span></label>
                <div class="layui-input-block">
                    <input type="text" name="czGcZpjShr" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">再评价审核日期<span class="sign">*</span></label>
                <div class="layui-input-block">
                    <input type="text" name="czGcZpjShrq" id="date4" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label">再评价审核结果<span class="sign">*</span></label>
                <div class="layui-input-block">
                    <select name="czGcZpjShjg">
                        <option value="1">通过</option>
                        <option value="0">不通过</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="col-xs-12 col-sm-6">
            <div class="layui-form-item layui-form-text">
                <label class="layui-form-label">再评价审核意见<span class="sign">*</span></label>
                <div class="layui-input-block">
                    <textarea type="text" name="czGcZpjShyj" autocomplete="off" class="layui-textarea"></textarea>
                </div>
            </div>
        </div>
        <div class="col-xs-12">
            <div class="layui-form-item subBtn">
                <div class="layui-input-block">
                    <button class="layui-btn" lay-submit="" lay-filter="demo1">保存</button>
                    <button type="reset" class="layui-btn layui-btn-primary">重置</button>
                </div>
            </div>
        </div>
    </div>
    <input type="hidden" name="bmId" id="bmId" class="layui-input">
</form>
<div id="tips">

</div>


<script>
    formData = {};
    formData.count1 = 0;
    formData.eqSbzp = [];
    var emp=tempValue("rl", "emp", false);
    console.log(emp);
    $("#bmId").val(emp.bmId);
    $("#czGcNgr").val(emp.userXm);

    // 富文本
    layui.use('layedit', function(){
        var layedit = layui.layedit;
        layedit.build('czGcNr'); //建立编辑器
    });

    renderMod = {

       /* addTable: {

        },*/
        /*bind: {
            addItem: [
                {
                    elem: "#dataTable1",
                    base: "./child/medical-equipment.html",
                    name: "vg",
                    key: "key",
                    before: function () {
                        // console.log("scsName");
                        // $("#htYf").val($("#sbcsIdScs").val());
                    }
                },
                {
                    elem: "#addEmp",
                    base: "./child/add-Yf.html",
                    name: "dtdt",
                    key: "date"
                }

            ],
            delItem: ".delNew",
            selectItem: [
                {
                    elem: "#selectEmp",
                    cb: "/lifeManage/listHtBiaotou",
                    db: "/cs/listScs",
                    name: "dtdt",
                    key: "radio",
                    data: formData2,
                    func:function(){
                        console.log(formData2);
                    }
                }

            ]
        },*/
        form: {
            submit: {
               /* before: function (param) {
                    var tv = getTableValue("table");
                    var ab=$("#scsName").val();
                    $("#htYfName").val(ab);
                    if (doJudg({
                        "undefined": [formData2.radio],
                        0: [tv]
                    })) {
                        putMsg({
                            alert: "无法提交空数据！"
                        });
                        return false;
                    }
                    return param = {
                        1: tv,
                        2: formData2.radio[0]["sbcsIdScs"]
                    };


                },*/
                form: {
                    url: "/lifeManage/addEqHt",
                    type: "POST",
                    data: [
                        "htBianhao", "htQyd", "htJf","htJfq","htZgbfb", "htBzr", "htTsr", "htYsfk", "htZbj",
                        "htScrq", "htBxq", "htBxxy", "htBxdc", "htZgfg", "htBycs", "htLpjyhj","sbcsIdScs","htYfName"
                    ],
                    // key:"key",
                    contentType: "application/json",
                  /*  param: {
                        1: "listZb",
                        2:"htYf"
                    },*/
                    reload: true
                }
            },
            date: [
                {
                    elem: "#czGcNgrq",
                    value: today0,
                    type: "date",
                    format: 'yyyy-MM-dd'
                },
                {
                    elem: "#date3",
                    value: today0,
                    type: "date",
                    format: 'yyyy-MM-dd'
                },
                {
                    elem: "#date4",
                    value: today0,
                    type: "date",
                    format: 'yyyy-MM-dd'
                }
            ],
            file: [
                {
                    elem: "#sbzp",
                    url: "/lifeManage/importdjhwimgurls",
                    accept: "images",
                    acceptMime: "image/*",
                    multiple: true,
                    auto: false,
                    bindAction: "#sbzp_sub",
                    number: 6,
                    field: "imgs",
                    choose: function (obj) {
                        if (formData.count1 > 1) {
                            putMsg({
                                alert: "最多只能上传1张图！"
                            });
                            return false;
                        }
                        var files = this.files = obj.pushFile();
                        obj.preview(function (index, file, result) {
                            var tr = $(['<tr id="upload-' + index + '">'
                                , '<td>' + file.name + '</td>'
                                , '<td>' + (file.size / 1014).toFixed(1) + 'kb</td>'
                                , '<td>等待上传</td>'
                                , '<td>'
                                , '<button class="layui-btn layui-btn-xs demo-see" data-img="' + result + '">查看</button>'
                                , '<button class="layui-btn layui-btn-xs layui-btn-danger demo-delete">删除</button>'
                                , '</td>'
                                , '</tr>'].join(''));

                            //查看
                            tr.find('.demo-see').on('click', function () {
                                layOpen({
                                    type: 1,
                                    content: "<img src='" + $(this).attr("data-img") + "' style='width:100%;' />",
                                    area: ["80%", "80%"]
                                });
                                return false;
                            });

                            //删除
                            tr.find('.demo-delete').on('click', function () {
                                layer.confirm("确认删除这张图吗？", function (index) {
                                    delete files[index]; //删除对应的文件
                                    tr.remove();
                                    var inp = $("#sbzp").next().val("");
                                    formData.count1--;
                                    layer.close(index);
                                });
                                return false;
                            });

                            $("#demoList1").append(tr);
                            formData.count1++;
                        });
                    }, done: function (res, index, upload) {
                        if (res.code === 0) {
                            formData.eqSbzp.push(res.data);
                            var tr = $("#demoList1").find('tr#upload-' + index)
                                , tds = tr.children();
                            tds.eq(2).html('<span style="color: #5FB878;">上传成功</span>');
                            tds.eq(3).html(''); //清空操作
                            $("#gcUrl").val($("#gcUrl").val() + res.data);
                            console.log($("#gcUrl").val())
                            return delete this.files[index]; //删除文件队列已经上传成功的文件
                        }
                        this.error(index, upload);
                    }, error: function (index, upload) {
                        var tr = $("#demoList1").find('tr#upload-' + index)
                            , tds = tr.children();
                        tds.eq(2).html('<span style="color: #FF5722;">上传失败</span>');
                        console.log("index:" + index);
                        console.log("upload" + upload);
                    }
                }
            ]
        }
    }
</script>
</body>

</html>