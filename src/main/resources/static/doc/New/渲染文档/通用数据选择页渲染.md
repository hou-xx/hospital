> Markdown说明：本文档使用 Typora 编写，如格式出现错误，请尝试使用 Typora 打开本文档
>
> 作者：张小富
>
> 创建时间：2019-2-13
>
> 修改时间：

#  /global/data.html页面渲染说明

为了增强页面复用，所有数据选择页均使用data.html来选择，data.html页面需要后台返回数据进行渲染。

**自定义参数（需传入）**

| 属性名 |      默认值       | 含义                                       |
| :----: | :---------------: | ------------------------------------------ |
|   cb   |        ""         | 获取表头的链接                             |
|   db   |        ""         | 获取表格数据的链接                         |
|   se   |        ""         | 获取搜索数据的链接                         |
|  key   |         -         | 获取数据时发送的数据，主要用于区分不同页面 |
|   vg   |      "dtdt"       | 数据选定后保存到session表名                |
|   v    | key \| "tempData" | session表内对应的key值                     |

**cb参数说明：**

根据layui要求，表头必须为二维数据。

在表头链接返回的数据中若返回的是一维数组，则会自动嵌套一层数组并使用，

若返回的是二维数组则会直接使用。

- 常用表头数据：

  ```javascript
  //单选
  {radio:true}
  //或
  {type:"radio"}
  //多选
  {checkbox: true}
  //或
  {type:"checkbox"}
  //普通表头 field => 匹配data中的参数名 title => 表格中显示的名称
  {field: 'username', title: '用户名'}
  //含有格式化日期的表头
  {field：'time',title:'',templet:'#timeFormat'}
  ```

**se参数说明：**

- **se参数返回数据包含两部分：**

  | 参数名 | 参数类型 | 参数说明               |
  | ------ | -------- | ---------------------- |
  | dom    | String   | 页面搜索所需的DOM      |
  | data   | Json     | 页面发起搜索所需的参数 |

- **常用搜索DOM**

  可以将以下代码保存成字符串拼接成所需DOM传输

  **当不填写se参数的时候默认无搜索**

  **不建议使用复杂搜索DOM**

  ```html
  //搜索框 【 name 】 【 placeholder 】 可自定义
  <input class="layui-input" name="search" placeholder="搜索....">
  
  //下拉框 <option> 标签内内容可以自定义 【 lay-filter 】【 value 】可自定义 
  //第一项value留空表示默认填充 可加 selected 属性选中任意行
  <select name="interest" lay-filter="re">
  	<option value="">选择一个内容</option>
  	<option value="1">111</option>
  	<option value="2">222</option>
  </select>
  ```


- **搜索DOM必须添加**

  **dom参数中必须添加一个搜索按钮：**

  ```html
  //【 data-type 】 <button>标签内内容 可以自定义
  <div class="layui-input-inline mar10-0" align="center">
  	<button class="layui-btn" data-type="reload">搜索</button>
  </div>
  ```

- **常用搜索参数**

  ```javascript
  //具体参见 表格渲染文档 reSet参数
  data:{
      url:"#",
      type:"search",
      data:["name1","name2"],//DOM中自定义的表单name
      where:{
          newValue:"thisIsNew"
      },//其他参数，可以不填
      dat:["#date","bTime","eTime","~"],//时间选择器的拆分
      tid:"#table//表格ID，可不填
  }
  ```


**vg / v 参数说明：**

vg参数和v参数用于传递参数，传入的参数将被用于选定数据保存已选择的数据到session中便于读取

**代码示例：**

- data.html链接示例：

  ```javascript
  url:"/global/data.html?cb=localhost/head&db=localhost/data&se=localhost/search&key=1"
  ```

- 表头返回数据示例：

  ```javascript
  [
      {type:"redio"},
      {field:"name",title:"数据名称"},
      {field:"key",title"键值"}
  ]
  ```

- 表格数据返回示例：

  ```javascript
  [
      {name:"CT","key":"50"},
      {name:"CT1","key":"10"},
      {name:"CT2","key":"1"},
      {name:"CT3","key":"2"},
  ]
  ```

- 搜索链接返回示例

  ```javascript
  {
      dom:"<input class='layui-input' name='search' placeholder='搜索....'>
      <div class='layui-input-inline mar10-0' align='center'>
  	<button class='layui-btn' data-type='reload'>搜索</button>
  </div>",
      data:{
          url:"###",
      	type:"reload",
      	data:["search"]
      }
  }
  ```

  

