# 内容传输与提交(subUp)函数文档

subUp函数用于数据的获取与表单的提交。

**参数：**

subUP函数支持三种不同的方式提交数据：

`html表单提交(同步)` `xhr(JS)提交表单(异步)` `ajax(JQ)提交表单(异步)` 

使用 `switch参数`切换不同的提交方式，例：

```javascript
switch:"html"  //以传统的表单形式提交数据
switch:"xhr"   //以XHR方式提交数据
switch:"ajax"  //以AJAX方式提交数据
```

**表单传递默认是以AJAX形式传递（当switch不存在或不为其余两种方式时均以AJAX形式提交）**

每种表单提交方式需要传递的代码有所不同

- HTML表单提交(传统同步提交)

  > 传统的表单中会自动获取所有的表单的数据，由于此方式设计用于个别情况，故不再深入设计此方式。**所需的附加代码需加在表单对应位置。**
  >
  > 页面会创建新的HTML框架来获取返回数据，故页面不会跳转新页面，但是返回数据不会显示出来，提交后会弹框提示 提交成功

  **数据中支持填写的参数：**

  | 参数名 | 是否必填 | 说明                     | 默认值      |
  | ------ | -------- | ------------------------ | ----------- |
  | method | 否       | 数据提交方式（POST/GET） | ‘GET’       |
  | url    | 是       | 数据提交地址             | 无          |
  | target | 否       | 新创建iframe框架name值   | 'framesXXX' |

- XHR表单提交(JS异步提交)

  > JS的异步提交方式还有一些问题未解决，并且受限于使用场景及其有限，故功能有限

  > **强烈推荐不是万不得已不要使用这个方法提交数据，代码未经测试，问题未修复**

  **数据中支持的参数：**

  | 参数名 | 是否必填 | 说明                     | 默认值 |
  | ------ | -------- | ------------------------ | ------ |
  | method | 否       | 数据提交方式（POST/GET） | "GET"  |
  | url    | 是       | 数据提交地址             | 无     |
  | async  | 否       | 数据提交同步方式         | true   |

- AJAX表单提交(JQ异步提交)

  JQ的异步提交方式极大的简化了使用步骤，只需填写以下必填参数即可。

  > 已使用方法获取异步提交成功返回的数据，可以在ajax外获取与使用

  **数据中支持的参数：**

  | 参数名  | 是否必填 | 说明                           | 默认值 |
  | ------- | -------- | ------------------------------ | ------ |
  | url     | 是       | 数据提交地址                   | 无     |
  | type    | 否       | 数据提交方式                   | "GET"  |
  | data    | 是       | 所需提交的数据                 | 无     |
  | success | 否       | 成功获得数据执行               | 见下   |
  | error   | 否       | 数据发送失败执行               | 见下   |
  | done    | 否       | 数据成功发送后在判断结束后执行 | 无     |
  | add     | 否       | 发送成功后附加数据             | 无     |
  | fine    | 否       | 发送失败后附加数据             | 无     |

  > 此处只列出了基本参数，如需其他参数请参考[JQuery官方文档](http://api.jquery.com/jquery.ajax/)，直接填写即可

  - **data参数说明：**

    借助layui函数封装的参数，只需填写一个表单name数组即可自动获取所有数组对应表单数据，需要除了表单以外的数据时需添加add参数

    - 例如：

      ```javascript
      data:["id","password","verfi"];//提交ID 密码 验证 内容
      
      data:["ids","passw"];          //提交ID 密码 并附加code=0
      add:{
          code:0
      }
      ```



  - **success参数说明：**

    success已封装默认操作，但是只会判断数据是否成功（通过判断返回数据data.code=0则成功 =1则失败），使用默认判断后需执行的操作请使用`done参数`定义，**不论成功与否均会执行done参数内函数（除非done不存在）**

  - **error参数说明：**

    error参数已封装默认操作，当提交失败时将弹框提示 `提交失败` 并且会在控制台中显示出错误信息。可以为其定义`fine参数`执行相关操作，已为其添加错误信息的参数

**示例：**

```javascript
//以HTML方式提交数据
subUp({
    switch:"html",
    method:"POST",
    url:"localhost"
});
//以AJAX方式提交数据
//例子一：
subUp({
    url:"localhost",
    type:"POST",
    data:["name1","name2","name3"],
    add:{
        id:666
    }
})
//例子二：
subUp({
    url:"localhost",
    type:"POST",
    data:{
        id:666
    }
})
```

> 撰写人：张小富
>
> 撰写日期：2019-01-18